<!DOCTYPE html><html lang="en"> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/x-icon" href="/favicon.ico"><meta name="generator" content="Astro v5.16.4"><!-- Canonical URL --><link rel="canonical" href="https://vikassharma.me/leetcode-121-best-time-to-buy-and-sell-stock/"><!-- Primary Meta Tags --><title>121. Best Time to Buy and Sell Stock | &lt;/&gt; Vikas Sharma</title><meta name="title" content="121. Best Time to Buy and Sell Stock"><meta name="description" content="<meta name=&#34;twitter:card&#34; content=&#34;summarylargeimage&#34;> <meta name=&#34;twitter:site&#34; content=&#34;@i_vikassharma&#34;> <meta name=&#34;twitter:creator&#34; content=&#34;@i_vikassharma&#34;..."><!-- Open Graph / Facebook --><meta property="og:type" content="article"><meta property="og:url" content="https://vikassharma.me/leetcode-121-best-time-to-buy-and-sell-stock/"><meta property="og:title" content="121. Best Time to Buy and Sell Stock"><meta property="og:description" content="<meta name=&#34;twitter:card&#34; content=&#34;summarylargeimage&#34;> <meta name=&#34;twitter:site&#34; content=&#34;@i_vikassharma&#34;> <meta name=&#34;twitter:creator&#34; content=&#34;@i_vikassharma&#34;..."><meta property="og:image" content="https://vikassharma.me/images/l-buy-and-sell.jpeg"><meta property="article:published_time" content="2023-09-18T07:31:00.000Z"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://vikassharma.me/leetcode-121-best-time-to-buy-and-sell-stock/"><meta property="twitter:title" content="121. Best Time to Buy and Sell Stock"><meta property="twitter:description" content="<meta name=&#34;twitter:card&#34; content=&#34;summarylargeimage&#34;> <meta name=&#34;twitter:site&#34; content=&#34;@i_vikassharma&#34;> <meta name=&#34;twitter:creator&#34; content=&#34;@i_vikassharma&#34;..."><meta property="twitter:image" content="https://vikassharma.me/images/l-buy-and-sell.jpeg"><!-- RSS Feed --><link rel="alternate" type="application/rss+xml" title="</> Vikas Sharma" href="https://vikassharma.me/rss.xml"><!-- Sitemap --><link rel="sitemap" href="/sitemap-index.xml"><!-- Google Tag Manager --><script>(function(){const GTM_ID = "GTM-WC7F9C2X";

  (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer',GTM_ID);
})();</script><!-- End Google Tag Manager --><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-X8FQN553XQ"></script><script>(function(){const GA_ID = "G-X8FQN553XQ";

  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', GA_ID);
})();</script><style>:root{--width: 800px;--font-main: Verdana, sans-serif;--font-secondary: Verdana, sans-serif;--font-scale: 1em;--background-color: #fff;--heading-color: #222;--text-color: #444;--link-color: #3273dc;--visited-color: #8b6fcb;--code-background-color: #f2f2f2;--code-color: #222;--blockquote-color: #222}@media(prefers-color-scheme:dark){:root{--background-color: #01242e;--heading-color: #eee;--text-color: #ddd;--link-color: #8cc2dd;--visited-color: #8b6fcb}}body.dark-mode{--background-color: #01242e;--heading-color: #eee;--text-color: #ddd;--link-color: #8cc2dd;--visited-color: #8b6fcb;--code-background-color: #0d1117;--code-color: #ddd;--blockquote-color: #ccc}body{font-family:var(--font-secondary);font-size:var(--font-scale);margin:auto;padding:20px;max-width:var(--width);text-align:left;background-color:var(--background-color);word-wrap:break-word;overflow-wrap:break-word;line-height:1.5;color:var(--text-color)}h1,h2,h3,h4,h5,h6{font-family:var(--font-main);color:var(--heading-color)}a{color:var(--link-color);cursor:pointer;text-decoration:none}a:hover{text-decoration:underline}nav a{margin-right:8px}strong,b{color:var(--heading-color)}button{margin:0;cursor:pointer}main{line-height:1.6}table{width:100%}hr{border:0;border-top:1px dashed}img{max-width:100%}pre{padding:20px}*:not(pre)>code{font-family:monospace;padding:2px;background-color:var(--code-background-color);color:var(--code-color);border-radius:3px}blockquote{border-left:1px solid #999;color:var(--code-color);padding-left:20px;font-style:italic}footer{padding:25px 0;text-align:center}time{font-family:monospace;font-style:normal;font-size:15px}.title:hover{text-decoration:none}.title h1{font-size:1.5em}.inline{width:auto!important}.highlight,.code{padding:1px 15px;background-color:var(--code-background-color);color:var(--code-color);border-radius:3px;margin-block-start:1em;margin-block-end:1em;overflow-x:auto}ul.blog-posts{list-style-type:none;padding:unset}ul.blog-posts li{display:flex}ul.blog-posts li span{flex:0 0 130px}ul.blog-posts li a:visited{color:var(--visited-color)}.tags{font-size:.83rem}.tag{margin-right:.25rem}.filter-title{margin-bottom:0}.remove-filter{font-size:.83rem}form{line-height:1}.item-index ul{list-style:none;padding:0;display:flex;flex-wrap:wrap;gap:.5rem}.item-index a{display:inline-block;padding:.25rem .75rem;border:1px solid var(--dim);border-radius:4px;text-decoration:none}ul.item-groups,.item-groups ul{list-style:none;padding:0;margin:0}.item-groups li{display:flex;align-items:baseline;gap:1ch;border-bottom:1px solid var(--dim)}.item-groups li:last-child{border-bottom:none}.item-groups li a{text-decoration:none}.item-groups time{color:var(--dim);font-size:.9rem;flex-shrink:0}.item-groups .title{text-decoration:underline}.preview-container{display:flex;flex-direction:column;gap:1rem;height:85vh}.pane{display:flex}.pane:first-of-type{height:40%}.pane:last-of-type{height:60%;overflow-y:auto;border:1px solid var(--dim);background:#fff}#markdown-input{width:100%;flex-grow:1;border:1px solid var(--dim);padding:1rem;font-family:monospace;font-size:16px;resize:vertical;background:#00000005}#preview-wrapper{width:100%}#preview-wrapper h1:first-child{margin-top:0}.social-links{margin-top:2rem;display:flex;gap:1rem}.social-links a{text-decoration:none;padding:.5rem 1rem;border:1px solid #ccc;border-radius:5px}.social-links a:hover{background-color:#eee}.footer[data-astro-cid-sz7xmlte]{padding:2rem 0;text-align:center}main[data-astro-cid-ivdev4kk]{flex-grow:1}body{display:flex;flex-direction:column;min-height:100vh}
.category-links[data-astro-cid-33jieqlm]{margin-top:1rem;margin-bottom:1rem;font-size:.9rem;color:var(--dim)}.category-links[data-astro-cid-33jieqlm] a[data-astro-cid-33jieqlm]{text-decoration:underline;text-decoration-style:dotted}
</style></head> <body data-astro-cid-yxt6t7ye> <!-- Google Tag Manager (noscript) --> <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WC7F9C2X" height="0" width="0" style="display:none;visibility:hidden" data-astro-cid-yxt6t7ye></iframe></noscript> <!-- End Google Tag Manager (noscript) --> <header> <a class="title" href="/"> <h1>&lt;/&gt; Vikas Sharma</h1> </a> <nav> <p> <a href="/">Home</a> <a href="/blog">Blog</a> <a href="/about">About</a> <a href="/rss.xml">RSS</a> </p> </nav> </header> <main data-astro-cid-ivdev4kk>    <article> <img src="/images/l-buy-and-sell.jpeg" alt="121. Best Time to Buy and Sell Stock" class="header-image" loading="lazy"> <h1>121. Best Time to Buy and Sell Stock</h1> <time datetime="2023-09-18T07:31:00.000Z">18 Sep, 2023</time> <div class="category-links" data-astro-cid-33jieqlm>
categories:
<a href="/categories#technical" data-astro-cid-33jieqlm>technical</a>, <a href="/categories#leetcode" data-astro-cid-33jieqlm>leetcode</a>, <a href="/categories#blind-75" data-astro-cid-33jieqlm>blind-75</a>, <a href="/categories#sliding-window" data-astro-cid-33jieqlm>sliding-window</a></div> <hr>  <meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@i_vikassharma">
<meta name="twitter:creator" content="@i_vikassharma">
<meta name="twitter:title" content="121. Best Time to Buy and Sell Stock">
<meta name="twitter:description" content="How to solve leetcode problem no. 121 best-time-to-buy-and-sell-stock">
<p>
    <a href="https://leetcode.com/problems/best-time-to-buy-and-sell-stock/" target="_blank">
        You are given an array prices where prices[i] is the price of a given stock on the ith day.
</a></p><p><a href="https://leetcode.com/problems/best-time-to-buy-and-sell-stock/" target="_blank">You want to maximize your profit by choosing a single day to buy one stock and choosing a different day in the future to sell that stock.</a></p><a href="https://leetcode.com/problems/best-time-to-buy-and-sell-stock/" target="_blank">
</a><p><a href="https://leetcode.com/problems/best-time-to-buy-and-sell-stock/" target="_blank">Return the maximum profit you can achieve from this transaction. If you cannot achieve any profit, return 0.
</a></p>
<p></p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>Example 1:</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Input: prices = [7,1,5,3,6,4]</span></span>
<span class="line"><span>Output: 5</span></span>
<span class="line"><span>Explanation: Buy on day 2 (price = 1) and sell on day 5 (price = 6), profit = 6-1 = 5.</span></span>
<span class="line"><span>Note that buying on day 2 and selling on day 1 is not allowed because you must buy before you sell.</span></span>
<span class="line"><span>Example 2:</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Input: prices = [7,6,4,3,1]</span></span>
<span class="line"><span>Output: 0</span></span>
<span class="line"><span>Explanation: In this case, no transactions are done and the max profit = 0.</span></span>
<span class="line"><span> </span></span>
<span class="line"><span></span></span>
<span class="line"><span>Constraints:</span></span>
<span class="line"><span></span></span>
<span class="line"><span>1 &#x3C;= prices.length &#x3C;= 105</span></span>
<span class="line"><span>0 &#x3C;= prices[i] &#x3C;= 104</span></span></code></pre>
<h2 id="intuition">Intuition</h2>
<h3 id="first-thoughts">First thoughts</h3>
<p>In order to solve this question in a brute-force way, we’ll have to:</p>
<ul>
<li>loop through all the elements and for each element (i.e. selecting the current element as our buying price):
<ul>
<li>we need to check against all the possible selling points (i.e. all the prices after our chosen buying price).
<ul>
<li>calculate if we are going to make any profit with the pair of chosen <code>buy price</code> and <code>sell price</code>. Record that in higher level variable (let’s call it <code>max_profit</code> - only need to store the maximum obtained so far)</li>
</ul>
</li>
</ul>
</li>
<li>by end of the first loop, we’ll have our answer recorded in the higher level variable <code>max_profit</code>.</li>
</ul>
<p>This approach has:</p>
<ul>
<li>run time complexity of O(n<sup>2</sup>) (as we have nested loops).</li>
<li>space complextity of O(1) (since our storage needs doesn’t grow with input size i.e. size of the allocated variable <code>max_profit</code> is going to be same for any input size).</li>
</ul>
<h3 id="further-thoughts">Further thoughts</h3>
<p>Can we do better than O(n<sup>2</sup>)?</p>
<ul>
<li>In our brute-force approach, for each potential buying price, we are eventually looking for the best possible selling price. The inefficiency in this approach is that it keeps looking for the selling price, <code>even if our current profit becomes 0 or -ve at certain point</code>. We know for sure that for such cases, our chosen buying price can’t really be the solution to our problem as a better buying price exists at later stage due to which the profit becomes either 0 or -ve.</li>
<li>Let’s consider an example <code>prices = [7,2,5,1,3,6,4]</code>. Assume that we are at <code>day 2 (price=2, index=1)</code>. Now, while looking for potential selling prices, at some point in time, we would consider <code>selling at day 4 (price=1, index=3)</code>. At that point the current profit would have been become -1. Which essentially means that there is no point in considering our current buying price (index=1) because either same or better buying price exists at later stage. So, we can safely ignore the intermediate buying prices and directly move to index=3.</li>
<li>From there on, we can keep looking for the optimal selling price:
<ul>
<li>till we run out of all potential prices.</li>
</ul>
</li>
<li>At each valid selling point, we record the candidate result in the higher level variable <code>max_profit</code> (only if we find any better result from the previously computed candidates).</li>
<li>If we stumble upon a situation where we encounter <code>-ve profit</code>, we ignore looking any further and we move to next possible buying price.</li>
</ul>
<h3 id="final-approach">Final approach</h3>
<ul>
<li>Initialize a varible namely <code>max_profit</code> with current value as <code>0</code>.</li>
<li>Loop through all the elements of given array.
<ul>
<li>keep looking for potential selling prices, till the computed profit so far is <code>>= 0</code>.</li>
<li>otherwise, (i.e. current profit gets -ve):
<ul>
<li>Move to the current selling price being considered.</li>
</ul>
</li>
<li>while we keep getting +ve result store the max of <code>max_profit</code> and <code>current profit</code> in the variable <code>max_profit</code>.</li>
</ul>
</li>
<li>By end of the main loop we would have gotten our result in the variable <code>max_profit</code>. Time to just return it.</li>
<li>Time complexity: O(n) (since we only process all the elements at max 2 times).</li>
<li>Space complexity: O(1) (since our auxiliary storage <code>max_profit</code> doesn’t grow with input size).</li>
</ul>
<h3 id="python-code">Python code</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> Solution</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#F97583">    def</span><span style="color:#B392F0"> maxProfit</span><span style="color:#E1E4E8">(self, prices: List[</span><span style="color:#79B8FF">int</span><span style="color:#E1E4E8">]) -> </span><span style="color:#79B8FF">int</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">        max_profit, buy_price_idx, sell_price_idx </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 0</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">0</span></span>
<span class="line"><span style="color:#F97583">        while</span><span style="color:#E1E4E8"> sell_price_idx </span><span style="color:#F97583">&#x3C;</span><span style="color:#79B8FF"> len</span><span style="color:#E1E4E8">(prices):</span></span>
<span class="line"><span style="color:#E1E4E8">            current_profit </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> prices[sell_price_idx] </span><span style="color:#F97583">-</span><span style="color:#E1E4E8"> prices[buy_price_idx]</span></span>
<span class="line"><span style="color:#F97583">            if</span><span style="color:#E1E4E8"> current_profit </span><span style="color:#F97583">>=</span><span style="color:#79B8FF"> 0</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">                max_profit </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> max</span><span style="color:#E1E4E8">(max_profit, current_profit)</span></span>
<span class="line"><span style="color:#E1E4E8">                sell_price_idx </span><span style="color:#F97583">+=</span><span style="color:#79B8FF"> 1</span></span>
<span class="line"><span style="color:#F97583">            else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">                buy_price_idx </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> sell_price_idx</span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#E1E4E8"> max_profit</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Alternative thinking model in terms of sliding window</span></span>
<span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> Solution</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#F97583">    def</span><span style="color:#B392F0"> maxProfit</span><span style="color:#E1E4E8">(self, prices: List[</span><span style="color:#79B8FF">int</span><span style="color:#E1E4E8">]) -> </span><span style="color:#79B8FF">int</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">        buy, maxProfit </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 0</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">        </span></span>
<span class="line"><span style="color:#F97583">        for</span><span style="color:#E1E4E8"> sell </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> range</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">len</span><span style="color:#E1E4E8">(prices)):</span></span>
<span class="line"><span style="color:#6A737D">            # expand</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">            # record candidate result if window is valid</span></span>
<span class="line"><span style="color:#F97583">            if</span><span style="color:#E1E4E8"> prices[buy] </span><span style="color:#F97583">&#x3C;=</span><span style="color:#E1E4E8"> prices[sell]:</span></span>
<span class="line"><span style="color:#E1E4E8">                maxProfit </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> max</span><span style="color:#E1E4E8">(maxProfit, prices[sell]</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">prices[buy])                </span></span>
<span class="line"><span style="color:#E1E4E8">            </span></span>
<span class="line"><span style="color:#6A737D">            # shrink</span></span>
<span class="line"><span style="color:#F97583">            if</span><span style="color:#E1E4E8"> prices[sell] </span><span style="color:#F97583">&#x3C;</span><span style="color:#E1E4E8"> prices[buy]:</span></span>
<span class="line"><span style="color:#E1E4E8">                buy </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> sell</span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#E1E4E8"> maxProfit</span></span></code></pre>  </article>    </main>  <footer class="footer" data-astro-cid-sz7xmlte> <div class="container" data-astro-cid-sz7xmlte> <p data-astro-cid-sz7xmlte>&copy; 2026 Vikas Sharma. All rights reserved.</p> </div> </footer>  </body> </html>